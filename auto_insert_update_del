from pymysql import *

class PRODUCT(object):
    def __init__(self):
        self.conn=connect(host='localhost', port=3306, user='root', password='111', database='shop', charset='utf8')
        self.cursor=self.conn.cursor()

    def __del__(self):
        self.cursor.close()
        self.conn.close()

    def execute_sql(self,sql):
        self.cursor.execute(sql)
        for item in self.cursor.fetchall():
            print(item)

    def show_all(self):
        sql='select * from product;'
        self.execute_sql(sql)

    def show_name(self):
        sql='select product_name from product;'
        self.execute_sql(sql)

    def show_sale_price(self):
        sql='select sale_price from product;'
        self.execute_sql(sql)

    def insert_col(self):
        record=input('please enter a record you want to insert')
        sql='insert into product values(%s);'%record
        self.cursor.execute(sql)
        self.conn.commit()

    def delete_col(self):
        title=input('enter the title you want to delete: ')
        cont=input('enter a char that you want to delete: ')
        sql='delete from product where (%s) = ("%s");'%(title,cont)
        self.cursor.execute(sql)
        self.conn.commit()

    def update_item(self):
        item_name_new=input('enter a new item')
        item_name_old=input('enter the old item')
        sql='update product set product_name=("%s") where product_name=("%s");'%(item_name_new,item_name_old)
        self.cursor.execute(sql)
        self.conn.commit()

    @staticmethod
    def print_menu():
        print('----product_table----')
        print('1: all items')
        print('2: all product_name')
        print('3: sale_price')
        print('4: want to add a product record')
        print('5: want to delete a column')
        print('6: want to update a element')
        print('q: want to quit the loop')
        return input('please enter order!')

    def run(self):
        while True:
            num=self.print_menu()
            if num=='1':
                self.show_all()
            elif num=='2':
                self.show_name()
            elif num=='3':
                self.show_sale_price()
            elif num=='4':
                self.insert_col()
            elif num=='5':
                self.delete_col()
            elif num=='6':
                self.update_item()
            elif num=='q':
                break
            else:
                print('please enter a valid number in (1,2,3,4,5,6,q)')

def main():
    product=PRODUCT()
    product.run()

if __name__=='__main__':
    main()
